/*
Description			: use 'os'.
Default value		: /
The scope of value	: /
First used			: /
*/
var os = require('os');

/***********************************************************************
**Function Name	: getOSInfo
**Description	: get os information.
**Parameters	: none.
**Return		: none.
***********************************************************************/
function getOSInfo()
{
	var osInfo = 
	{
		arch:"",
		osPlatform:["",""],
		uptime:0,
		totallMem:0,
		usedMem:0,
		cpuModel:"",
		cpusRate:0
	};
	var cpus;
	var tmp = 0;
	var cpusRate = 0;
	var idleTime = 0;
	var totallTime = 0;
	var i = 0;

	osInfo.totallMem = os.totalmem();
	osInfo.usedMem = os.totalmem() - os.freemem();
	osInfo.arch = os.arch();
	osInfo.osPlatform[0] = os.platform();
	osInfo.osPlatform[1] = os.release();
	osInfo.uptime = os.uptime();
	
	cpus = os.cpus();
	
	for (i = 0; i < cpus.length; ++i)
	{
		idleTime = cpus[i].times.idle;
		totallTime = (cpus[i].times.user + cpus[i].times.nice + cpus[i].times.irq + cpus[i].times.sys + cpus[i].times.idle);
		tmp = idleTime / totallTime;
		tmp = (1 - tmp);
		cpusRate = cpusRate + tmp;
	}
	
	cpusRate = cpusRate / cpus.length;
	
	osInfo.cpusRate = Number(cpusRate.toFixed(2)) * 100;
	
	osInfo.cpuModel = cpus[0].model;

	return osInfo;
}

exports.getOSInfo = getOSInfo;


